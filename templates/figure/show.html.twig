{% extends 'base.html.twig' %}

{% block title %}{{ figure.nom }}{% endblock %}

{% block main %}
        {% set figureId = app.request.attributes.get('id') %}

    <div id="figure_details">
        <div id="figure_header" style="background-image: url('{% if figure.defaultImage is not null %}/medias/{{ figure.defaultImage.urlMedia }}{% else %}/images/home_img.jpg{% endif %}')">
        {% if is_granted('ROLE_USER') %}
            <div id="figure_option"><div id="options"><a href="{{ path('app_figure_edit', {'slug': figure.slug }) }}"><img src="/images/pencil.png" alt="Logo d'un crayon" title="Modifier la figure"></a><a href="{{ path('app_figure_delete', {'slug': figure.slug }) }}" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette figure ?')"><img src="/images/trash.png" alt="Logo d'une corbeille" title="Supprimer la figure"></a></div></div>
        {% endif %}
            <div id="figure_title"{% if is_granted('ROLE_USER') %}style="margin-top: -50px;"{% endif %}>
                <h1>{{ figure.nom }}</h1>
            </div>
        </div>
        <div id="figure_medias">
            {% for image in images %}
            <div class="image_media">
                <img class="image_media_file" src="{{ asset('medias/'~image.urlMedia) }}">
            </div>
            {% endfor %}
            {% for video in videos %}
                <div class="image_media">
                    {{ video.urlMedia|raw }}
                </div>
            {% endfor %}
        </div>
        <div id="figure_text">
            <p>{{ figure.description }}<p>
            <div id="figure_informations">
                <div>Rédigé par : {{ figure.user.username }}</div>
                <div>Créé le : {{ figure.dateCreation|format_datetime('full', 'short') }}</div>
                {% if figure.dateMaj is not null %}<div>Modifié le : {{ figure.dateMaj|format_datetime('full', 'short') }}</div>{% endif %}
                <div>Groupe : {{ figure.groupe }}</div>
            </div>
        </div>
        {% if app.user %}
        {{ form_errors(form) }}

        {{ form_start(form, {'attr': {'id': 'comment_form'}}) }}
            {{ form_row(form.commentaire, {
                'row_attr': {'class': 'comment_label_input'}})
                }}<br>
            <button type="submit" class="btn">Envoyer un commentaire</button>

        {{ form_end(form) }}
        {% endif %}
        <div id="figure_comments">
        {% if comments is not empty %}
            {% for comment in comments %}
                <div class="comment }}">
                    <img src="/profil/{{ comment.user.urlPhotoProfil }}">
                    <div class="commentaire">
                        <div class="commentaire_message">{{ comment.commentaire }}</div>
                        <div class="commentaire_infos">
                            <p>Commenté par {{ comment.user.username }}</p>
                            <p>le {{ comment.date|format_datetime('full', 'short') }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
            <br>
            <div id="pagination">
            {% if page > 1 %}
                        <a class="btn" href="{{ path('app_figure_details', {'slug': figure.slug, page: page - 1 }) }}">Commentaires précedents</a>
            {% endif %}
            {% if page < maxPage %}
                        <a class="btn suivant" href="{{ path('app_figure_details', {'slug': figure.slug, page: page + 1 }) }}">Commentaires suivants</a>
            {% endif %}
            </div>
        {% else %}
            <p>Cette figure de snowboard n'a pas encore été commentée.</p>
        {% endif %}
        </div>
    </div>


{% endblock %}


{% block script %}
{% endblock %}
